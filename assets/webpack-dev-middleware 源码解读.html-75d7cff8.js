import{_ as a,z as c,A as l,Y as e,C as d,U as i,a6 as s,Q as o}from"./framework-cb9358d9.js";const r={},t=e("p",null,[e("img",{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/6/171e8d2b0103c1fa~tplv-t2oaga2asx-image.image",alt:""})],-1),v=e("br",null,null,-1),u={href:"https://www.zoo.team/article/webpack-dev-middleware",target:"_blank",rel:"noopener noreferrer"},p=e("h3",{id:"å‰è¨€",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#å‰è¨€","aria-hidden":"true"},"#"),d(" å‰è¨€")],-1),m={href:"https://www.webpackjs.com/configuration/dev-server/",target:"_blank",rel:"noopener noreferrer"},b=s(`<p>æˆªè‡³æœ¬æ–‡å‘è¡¨å‰ï¼Œwebpack-dev-middleware çš„æœ€æ–°ç‰ˆæœ¬ä¸º <code>webpack-dev-middleware@3.7.2</code>ï¼Œæœ¬æ–‡çš„æºç æ¥è‡ªäºæ­¤ç‰ˆæœ¬ã€‚æœ¬æ–‡ä¼šè®²è§£ webpack-dev-middleware çš„æ ¸å¿ƒæ¨¡å—å®ç°ï¼Œç›¸ä¿¡å¤§å®¶æŠŠè¿™ç¯‡æ–‡ç« çœ‹å®Œï¼Œå†å»é˜…è¯»æºç ï¼Œä¼šå®¹æ˜“ç†è§£å¾ˆå¤šã€‚</p><h3 id="webpack-dev-middleware-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#webpack-dev-middleware-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> webpack-dev-middleware æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŒ…ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>const wdm = require(&amp;#39;webpack-dev-middleware&amp;#39;);
const express = require(&amp;#39;express&amp;#39;);
const webpack = require(&amp;#39;webpack&amp;#39;);
const webpackConf = require(&amp;#39;./webapck.conf.js&amp;#39;);
const compiler = webpack(webpackConf);
const app = express();
app.use(wdm(compiler));
app.listen(8080);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),h={href:"http://www.expressjs.com.cn/",target:"_blank",rel:"noopener noreferrer"},x=e("code",null,"wdm(compiler)",-1),w=e("code",null,"app.use",-1),_=e("code",null,"wdm(compiler)",-1),g=e("code",null,"express",-1),k=e("code",null,"webpack",-1),f=e("code",null,"express",-1),j=e("h3",{id:"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-webpack-dev-middleware",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-webpack-dev-middleware","aria-hidden":"true"},"#"),d(" ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ webpack-dev-middleware")],-1),y=e("code",null,"webpack",-1),q=e("code",null,"webpack",-1),S={href:"https://www.webpackjs.com/configuration/watch/",target:"_blank",rel:"noopener noreferrer"},R=e("code",null,"webpack",-1),E=e("code",null,"watch mode",-1),N=s(`<p>è€Œ webpack-dev-middleware æ‹¥æœ‰ä»¥ä¸‹å‡ ç‚¹ç‰¹æ€§ï¼š</p><ul><li>ä»¥ <code>watch mode</code> å¯åŠ¨ <code>webpack</code>ï¼Œç›‘å¬çš„èµ„æºä¸€æ—¦å‘ç”Ÿå˜æ›´ï¼Œä¾¿ä¼šè‡ªåŠ¨ç¼–è¯‘ï¼Œç”Ÿäº§æœ€æ–°çš„ <code>bundle</code></li><li>åœ¨ç¼–è¯‘æœŸé—´ï¼Œåœæ­¢æä¾›æ—§ç‰ˆçš„ <code>bundle</code> å¹¶ä¸”å°†è¯·æ±‚å»¶è¿Ÿåˆ°æœ€æ–°çš„ç¼–è¯‘ç»“æœå®Œæˆä¹‹å</li><li><code>webpack</code> ç¼–è¯‘åçš„èµ„æºä¼šå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå½“ç”¨æˆ·è¯·æ±‚èµ„æºæ—¶ï¼Œç›´æ¥äºå†…å­˜ä¸­æŸ¥æ‰¾å¯¹åº”èµ„æºï¼Œå‡å°‘å»ç¡¬ç›˜ä¸­æŸ¥æ‰¾çš„ IO æ“ä½œè€—æ—¶</li></ul><p>è€Œæœ¬æ–‡å°†ä¸»è¦å›´ç»•è¿™ä¸‰ä¸ªç‰¹æ€§å’Œä¸»æµç¨‹é€»è¾‘è¿›è¡Œåˆ†æã€‚</p><h3 id="æºç è§£è¯»" tabindex="-1"><a class="header-anchor" href="#æºç è§£è¯»" aria-hidden="true">#</a> æºç è§£è¯»</h3><p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ webpack-dev-middleware çš„æºç ç›®å½•ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>...
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ DevMiddlewareError.js
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ middleware.js
â”‚   â””â”€â”€ utils
â”‚       â”œâ”€â”€ getFilenameFromUrl.js
â”‚       â”œâ”€â”€ handleRangeHeaders.js
â”‚       â”œâ”€â”€ index.js
â”‚       â”œâ”€â”€ ready.js
â”‚       â”œâ”€â”€ reporter.js
â”‚       â”œâ”€â”€ setupHooks.js
â”‚       â”œâ”€â”€ setupLogger.js
â”‚       â”œâ”€â”€ setupOutputFileSystem.js
â”‚       â”œâ”€â”€ setupRebuild.js
â”‚       â””â”€â”€ setupWriteToDisk.js
â”œâ”€â”€ package.json
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>lib</code> ç›®å½•ä¸‹ä¸ºæºä»£ç ï¼Œä¸€çœ¼æœ›å»æœ‰è¿‘ 10 å¤šä¸ªæ–‡ä»¶è¦è§£è¯»ã€‚ä½†åˆ¨é™¤ <code>utils</code> å·¥å…·é›†åˆç›®å½•ï¼Œå…¶æ ¸å¿ƒæºç æ–‡ä»¶å…¶å®åªæœ‰ä¸¤ä¸ª <code>index.js</code>ã€<code>middleware.js</code></p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥åˆ†ææ ¸å¿ƒæ–‡ä»¶ <code>index.js</code>ã€<code>middleware.js</code> çš„æºç å®ç°</p><h3 id="å…¥å£æ–‡ä»¶-index-js" tabindex="-1"><a class="header-anchor" href="#å…¥å£æ–‡ä»¶-index-js" aria-hidden="true">#</a> å…¥å£æ–‡ä»¶ index.js</h3><p>ä»ä¸Šæ–‡æˆ‘ä»¬å·²ç»å¾—çŸ¥ <code>wdm(compiler)</code> è¿”å›çš„æ˜¯ä¸€ä¸ª <code>express</code> ä¸­é—´ä»¶ï¼Œæ‰€ä»¥å…¥å£æ–‡ä»¶ <code>index.js</code> åˆ™ä¸ºä¸€ä¸ªä¸­é—´ä»¶çš„å®¹å™¨åŒ…è£…å‡½æ•°ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸º <code>webpack</code> çš„ <code>compiler</code>ã€å¦ä¸€ä¸ªä¸ºé…ç½®å¯¹è±¡ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„å¤„ç†ï¼Œæœ€åè¿”å›ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ã€‚ä¸‹é¢æˆ‘å°†å¯¹ <code>index.js</code> ä¸­çš„æ ¸å¿ƒä»£ç è¿›è¡Œè®²è§£ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>...
setupHooks(context);
...
// start watching
context.watching = compiler.watch(options.watchOptions, (err) =&amp;gt; {
  if (err) {
    context.log.error(err.stack || err);
    if (err.details) {
      context.log.error(err.details);
    }
  }
});
...
setupOutputFileSystem(compiler, context);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>index.js</code> æœ€ä¸ºæ ¸å¿ƒçš„æ˜¯ä»¥ä¸Š 3 ä¸ªéƒ¨åˆ†çš„æ‰§è¡Œï¼Œåˆ†åˆ«å®Œæˆäº†æˆ‘ä»¬ä¸Šæ–‡æåˆ°çš„ä¸¤ç‚¹ç‰¹æ€§ï¼š</p><ul><li>ä»¥ç›‘æ§çš„æ–¹å¼å¯åŠ¨ <code>webpack</code></li><li>å°† <code>webpack</code> çš„ç¼–è¯‘å†…å®¹ï¼Œè¾“å‡ºè‡³å†…å­˜ä¸­</li></ul><h3 id="setuphooks" tabindex="-1"><a class="header-anchor" href="#setuphooks" aria-hidden="true">#</a> setupHooks</h3><p>æ­¤å‡½æ•°çš„ä½œç”¨æ˜¯åœ¨ <code>compiler</code> çš„ <code>invalid</code>ã€<code>run</code>ã€<code>done</code>ã€<code>watchRun</code> è¿™ 4 ä¸ªç¼–è¯‘ç”Ÿå‘½å‘¨æœŸä¸Šï¼Œæ³¨å†Œå¯¹åº”çš„å¤„ç†æ–¹æ³•</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>context.compiler.hooks.invalid.tap(&amp;#39;WebpackDevMiddleware&amp;#39;, invalid);
context.compiler.hooks.run.tap(&amp;#39;WebpackDevMiddleware&amp;#39;, invalid);
context.compiler.hooks.done.tap(&amp;#39;WebpackDevMiddleware&amp;#39;, done);
context.compiler.hooks.watchRun.tap(
  &amp;#39;WebpackDevMiddleware&amp;#39;,
  (comp, callback) =&amp;gt; {
    invalid(callback);
  }
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨ <code>done</code> ç”Ÿå‘½å‘¨æœŸä¸Šæ³¨å†Œ <code>done</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸»è¦æ˜¯ <code>report</code> ç¼–è¯‘çš„ä¿¡æ¯ä»¥åŠæ‰§è¡Œ <code>context.callbacks</code> å›è°ƒå‡½æ•°</li><li>åœ¨ <code>invalid</code>ã€<code>run</code>ã€<code>watchRun</code> ç­‰ç”Ÿå‘½å‘¨æœŸä¸Šæ³¨å†Œ <code>invalid</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸»è¦æ˜¯ <code>report</code> ç¼–è¯‘çš„çŠ¶æ€ä¿¡æ¯</li></ul><h3 id="compiler-watch" tabindex="-1"><a class="header-anchor" href="#compiler-watch" aria-hidden="true">#</a> compiler.watch</h3>`,18),D=e("code",null,"compiler",-1),F={href:"https://www.webpackjs.com/api/node/#%E7%9B%91%E5%90%AC-watching-",target:"_blank",rel:"noopener noreferrer"},M=e("code",null,"webpack",-1),T=e("h3",{id:"setupoutputfilesystem",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#setupoutputfilesystem","aria-hidden":"true"},"#"),d(" setupOutputFileSystem")],-1),H={href:"https://www.npmjs.com/package/memory-fs",target:"_blank",rel:"noopener noreferrer"},O=e("code",null,"compiler",-1),W=e("code",null,"webpack",-1),B=s(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>fileSystem = new MemoryFileSystem();
// eslint-disable-next-line no-param-reassign
compiler.outputFileSystem = fileSystem;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Š 3 ä¸ªéƒ¨åˆ†çš„æ‰§è¡Œï¼Œæˆ‘ä»¬ä»¥ <code>watch mode</code> çš„æ–¹å¼å¯åŠ¨äº† <code>webpack</code>ï¼Œä¸€æ—¦ç›‘æµ‹çš„æ–‡ä»¶å˜æ›´ï¼Œä¾¿ä¼šé‡æ–°è¿›è¡Œç¼–è¯‘æ‰“åŒ…ï¼ŒåŒæ—¶æˆ‘ä»¬åˆå°†æ–‡ä»¶çš„å­˜å‚¨æ–¹æ³•æ”¹ä¸ºäº†å†…å­˜å­˜å‚¨ï¼Œæé«˜äº†æ–‡ä»¶çš„å­˜å‚¨è¯»å–æ•ˆç‡ã€‚æœ€åï¼Œæˆ‘ä»¬åªéœ€è¦è¿”å› <code>express</code> çš„ä¸­é—´ä»¶å°±å¯ä»¥äº†ï¼Œè€Œä¸­é—´ä»¶åˆ™æ˜¯è°ƒç”¨ <code>middleware(context)</code> å‡½æ•°å¾—åˆ°çš„ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>middleware</code> æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><h3 id="middleware-js" tabindex="-1"><a class="header-anchor" href="#middleware-js" aria-hidden="true">#</a> middleware.js</h3><p>æ­¤æ–‡ä»¶è¿”å›çš„æ˜¯ä¸€ä¸ª <code>express</code> ä¸­é—´ä»¶å‡½æ•°çš„åŒ…è£…å‡½æ•°ï¼Œå…¶æ ¸å¿ƒå¤„ç†é€»è¾‘ä¸»è¦é’ˆå¯¹ <code>request</code> è¯·æ±‚ï¼Œæ ¹æ®å„ç§æ¡ä»¶åˆ¤æ–­ï¼Œæœ€ç»ˆè¿”å›å¯¹åº”çš„æ–‡ä»¶å†…å®¹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>function goNext() {
  if (!context.options.serverSideRender) {
    return next();
  }
  return new Promise((resolve) =&amp;gt; {
    ready(
      context,
      () =&amp;gt; {
        // eslint-disable-next-line no-param-reassign
        res.locals.webpackStats = context.webpackStats;
        // eslint-disable-next-line no-param-reassign
        res.locals.fs = context.fs;
        resolve(next());
      },
      req
    );
  });
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é¦–å…ˆï¼Œ<code>middleware</code> ä¸­å®šä¹‰äº†ä¸€ä¸ª <code>goNext()</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆ¤æ–­æ˜¯å¦æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è°ƒç”¨ <code>ready()</code> æ–¹æ³•ï¼ˆæ­¤æ–¹æ³•å³ä¸º <code>ready.js</code> æ–‡ä»¶ï¼Œä½œç”¨ä¸ºæ ¹æ® <code>context.state</code> çŠ¶æ€åˆ¤æ–­ç›´æ¥æ‰§è¡Œå›è°ƒè¿˜æ˜¯å°†å›è°ƒå­˜å‚¨ <code>callbacks</code> é˜Ÿåˆ—ä¸­ï¼‰ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™ç›´æ¥è°ƒç”¨ <code>next()</code> æ–¹æ³•ï¼Œæµè½¬è‡³ä¸‹ä¸€ä¸ª <code>express</code> ä¸­é—´ä»¶ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>const acceptedMethods = context.options.methods || [&amp;#39;GET&amp;#39;, &amp;#39;HEAD&amp;#39;];
if (acceptedMethods.indexOf(req.method) === -1) {
  return goNext();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ç€ï¼Œåˆ¤æ–­ <code>HTTP</code> åè®®çš„è¯·æ±‚çš„ç±»å‹ï¼Œè‹¥è¯·æ±‚ä¸åŒ…å«äºé…ç½®ä¸­ï¼ˆé»˜è®¤ <code>GET</code>ã€<code>HEAD</code> è¯·æ±‚ï¼‰ï¼Œåˆ™ç›´æ¥è°ƒç”¨ <code>goNext()</code> æ–¹æ³•å¤„ç†è¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>let filename = getFilenameFromUrl(
  context.options.publicPath,
  context.compiler,
  req.url
);
if (filename === false) {
  return goNext();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œæ ¹æ®è¯·æ±‚çš„ <code>req.url</code> åœ°å€ï¼Œåœ¨ <code>compiler</code> çš„å†…å­˜æ–‡ä»¶ç³»ç»Ÿä¸­æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ï¼Œè‹¥æŸ¥æ‰¾ä¸åˆ°ï¼Œåˆ™ç›´æ¥è°ƒç”¨ <code>goNext()</code> æ–¹æ³•å¤„ç†è¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>return new Promise((resolve) =&amp;gt; {
  // eslint-disable-next-line consistent-return
  function processRequest() {
    ...
  }
  ...
  ready(context, processRequest, req);
});

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åï¼Œä¸­é—´ä»¶è¿”å›ä¸€ä¸ª <code>Promise</code> å®ä¾‹ï¼Œè€Œåœ¨å®ä¾‹ä¸­ï¼Œå…ˆæ˜¯å®šä¹‰ä¸€ä¸ª <code>processRequest</code> æ–¹æ³•ï¼Œæ­¤æ–¹æ³•çš„ä½œç”¨æ˜¯æ ¹æ®ä¸Šæ–‡ä¸­æ‰¾åˆ°çš„ <code>filename</code> è·¯å¾„è·å–åˆ°å¯¹åº”çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶æ„é€  <code>response</code> å¯¹è±¡è¿”å›ï¼Œéšåè°ƒç”¨ <code>ready(context, processRequest, req)</code> å‡½æ•°ï¼Œå»æ‰§è¡Œ <code>processRequest</code> æ–¹æ³•ã€‚è¿™é‡Œæˆ‘ä»¬ç€é‡çœ‹ä¸‹ <code>ready</code> æ–¹æ³•çš„å†…å®¹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>if (context.state) {
  return fn(context.webpackStats);
}
context.log.info(\`wait until bundle finished: \${req.url || fn.name}\`);
context.callbacks.push(fn);

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éå¸¸ç®€å•çš„æ–¹æ³•ï¼Œåˆ¤æ–­ <code>context.state</code> çš„çŠ¶æ€ï¼Œå°†ç›´æ¥æ‰§è¡Œå›è°ƒå‡½æ•° <code>fn</code>ï¼Œæˆ–åœ¨ <code>context.callbacks</code> ä¸­æ·»åŠ å›è°ƒå‡½æ•° <code>fn</code>ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸Šæ–‡æåˆ°çš„å¦ä¸€ä¸ªç‰¹æ€§ â€œåœ¨ç¼–è¯‘æœŸé—´ï¼Œåœæ­¢æä¾›æ—§ç‰ˆçš„ <code>bundle</code> å¹¶ä¸”å°†è¯·æ±‚å»¶è¿Ÿåˆ°æœ€æ–°çš„ç¼–è¯‘ç»“æœå®Œæˆä¹‹åâ€ã€‚è‹¥ <code>webpack</code> è¿˜å¤„äºç¼–è¯‘çŠ¶æ€ï¼Œ<code>context.state</code> ä¼šè¢«è®¾ç½®ä¸º <code>false</code>ï¼Œæ‰€ä»¥å½“ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼Œå¹¶ä¸ä¼šç›´æ¥è¿”å›å¯¹åº”çš„æ–‡ä»¶å†…å®¹ï¼Œè€Œæ˜¯ä¼šå°†å›è°ƒå‡½æ•° <code>processRequest</code> æ·»åŠ è‡³ <code>context.callbacks</code> ä¸­ï¼Œè€Œä¸Šæ–‡ä¸­æˆ‘ä»¬è¯´åˆ°åœ¨ <code>compile.hooks.done</code> ä¸Šæ³¨å†Œäº†å›è°ƒå‡½æ•° <code>done</code>ï¼Œç­‰ç¼–è¯‘å®Œæˆä¹‹åï¼Œå°†ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå¹¶å¾ªç¯è°ƒç”¨ <code>context.callbacks</code>ã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h3><p>æºç çš„é˜…è¯»æ˜¯ä¸€ä¸ªéå¸¸æ¯ç‡¥çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å®ƒçš„æ”¶ç›Šä¹Ÿæ˜¯å·¨å¤§çš„ã€‚ä¸Šæ–‡çš„æºç è§£è¯»ä¸»è¦åˆ†æçš„æ˜¯ <code>webpack-dev-middleware</code> å®ƒæ˜¯å¦‚ä½•å®ç°å®ƒæ‰€æ‹¥æœ‰çš„ç‰¹æ€§ã€å¦‚ä½•å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ç­‰ä¸»è¦åŠŸèƒ½ç‚¹ï¼ŒæœªåŒ…æ‹¬å…¶ä»–åˆ†æ”¯é€»è¾‘å¤„ç†ã€å®¹é”™ã€‚è¿˜éœ€è¯»è€…åœ¨è¿™ç¯‡æ–‡ç« åŸºç¡€ä¹‹ä¸Šï¼Œå†å»é˜…è¯»è¯¦ç»†çš„æºç ï¼Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹ä½ çš„é˜…è¯»è¿‡ç¨‹èµ·åˆ°ä¸€å®šçš„å¸®åŠ©ä½œç”¨ã€‚</p><h2 id="æ¨èé˜…è¯»" tabindex="-1"><a class="header-anchor" href="#æ¨èé˜…è¯»" aria-hidden="true">#</a> æ¨èé˜…è¯»</h2>`,17),C={href:"https://juejin.cn/post/6844903950508883982",target:"_blank",rel:"noopener noreferrer"},P={href:"https://juejin.cn/post/6844903988081475591",target:"_blank",rel:"noopener noreferrer"},A={href:"https://juejin.cn/post/6844904038555729927",target:"_blank",rel:"noopener noreferrer"},I=e("h2",{id:"æ‹›è´¤çº³å£«",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#æ‹›è´¤çº³å£«","aria-hidden":"true"},"#"),d(" æ‹›è´¤çº³å£«")],-1),V=e("p",null,"æ”¿é‡‡äº‘å‰ç«¯å›¢é˜Ÿï¼ˆZooTeamï¼‰ï¼Œä¸€ä¸ªå¹´è½»å¯Œæœ‰æ¿€æƒ…å’Œåˆ›é€ åŠ›çš„å‰ç«¯å›¢é˜Ÿï¼Œéš¶å±äºæ”¿é‡‡äº‘äº§å“ç ”å‘éƒ¨ï¼ŒBase åœ¨é£æ™¯å¦‚ç”»çš„æ­å·ã€‚å›¢é˜Ÿç°æœ‰ 50 ä½™ä¸ªå‰ç«¯å°ä¼™ä¼´ï¼Œå¹³å‡å¹´é¾„ 27 å²ï¼Œè¿‘ 3 æˆæ˜¯å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œå¦¥å¦¥çš„é’å¹´é£æš´å›¢ã€‚æˆå‘˜æ„æˆæ—¢æœ‰æ¥è‡ªäºé˜¿é‡Œã€ç½‘æ˜“çš„â€œè€â€å…µï¼Œä¹Ÿæœ‰æµ™å¤§ã€ä¸­ç§‘å¤§ã€æ­ç”µç­‰æ ¡çš„åº”å±Šæ–°äººã€‚å›¢é˜Ÿåœ¨æ—¥å¸¸çš„ä¸šåŠ¡å¯¹æ¥ä¹‹å¤–ï¼Œè¿˜åœ¨ç‰©æ–™ä½“ç³»ã€å·¥ç¨‹å¹³å°ã€æ­å»ºå¹³å°ã€æ€§èƒ½ä½“éªŒã€äº‘ç«¯åº”ç”¨ã€æ•°æ®åˆ†æåŠå¯è§†åŒ–ç­‰æ–¹å‘è¿›è¡ŒæŠ€æœ¯æ¢ç´¢å’Œå®æˆ˜ï¼Œæ¨åŠ¨å¹¶è½åœ°äº†ä¸€ç³»åˆ—çš„å†…éƒ¨æŠ€æœ¯äº§å“ï¼ŒæŒç»­æ¢ç´¢å‰ç«¯æŠ€æœ¯ä½“ç³»çš„æ–°è¾¹ç•Œã€‚",-1),L=e("p",null,[d("å¦‚æœä½ æƒ³æ”¹å˜ä¸€ç›´è¢«äº‹æŠ˜è…¾ï¼Œå¸Œæœ›å¼€å§‹èƒ½æŠ˜è…¾äº‹ï¼›å¦‚æœä½ æƒ³æ”¹å˜ä¸€ç›´è¢«å‘Šè¯«éœ€è¦å¤šäº›æƒ³æ³•ï¼Œå´æ— ä»ç ´å±€ï¼›å¦‚æœä½ æƒ³æ”¹å˜ä½ æœ‰èƒ½åŠ›å»åšæˆé‚£ä¸ªç»“æœï¼Œå´ä¸éœ€è¦ä½ ï¼›å¦‚æœä½ æƒ³æ”¹å˜ä½ æƒ³åšæˆçš„äº‹éœ€è¦ä¸€ä¸ªå›¢é˜Ÿå»æ”¯æ’‘ï¼Œä½†æ²¡ä½ å¸¦äººçš„ä½ç½®ï¼›å¦‚æœä½ æƒ³æ”¹å˜æ—¢å®šçš„èŠ‚å¥ï¼Œå°†ä¼šæ˜¯â€œ 5 å¹´å·¥ä½œæ—¶é—´ 3 å¹´å·¥ä½œç»éªŒâ€ï¼›å¦‚æœä½ æƒ³æ”¹å˜æœ¬æ¥æ‚Ÿæ€§ä¸é”™ï¼Œä½†æ€»æ˜¯æœ‰é‚£ä¸€å±‚çª—æˆ·çº¸çš„æ¨¡ç³Šâ€¦ å¦‚æœä½ ç›¸ä¿¡ç›¸ä¿¡çš„åŠ›é‡ï¼Œç›¸ä¿¡å¹³å‡¡äººèƒ½æˆå°±éå‡¡äº‹ï¼Œç›¸ä¿¡èƒ½é‡åˆ°æ›´å¥½çš„è‡ªå·±ã€‚å¦‚æœä½ å¸Œæœ›å‚ä¸åˆ°éšç€ä¸šåŠ¡è…¾é£çš„è¿‡ç¨‹ï¼Œäº²æ‰‹æ¨åŠ¨ä¸€ä¸ªæœ‰ç€æ·±å…¥çš„ä¸šåŠ¡ç†è§£ã€å®Œå–„çš„æŠ€æœ¯ä½“ç³»ã€æŠ€æœ¯åˆ›é€ ä»·å€¼ã€å½±å“åŠ›å¤–æº¢çš„å‰ç«¯å›¢é˜Ÿçš„æˆé•¿å†ç¨‹ï¼Œæˆ‘è§‰å¾—æˆ‘ä»¬è¯¥èŠèŠã€‚ä»»ä½•æ—¶é—´ï¼Œç­‰ç€ä½ å†™ç‚¹ä»€ä¹ˆï¼Œå‘ç»™ "),e("code",null,"ZooTeam@cai-inc.com")],-1),U=e("p",null,[e("img",{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/6/171e8b8d7ad15181~tplv-t2oaga2asx-image.image",alt:""})],-1);function z(G,Z){const n=o("ExternalLinkIcon");return c(),l("div",null,[t,e("p",null,[d("> è¿™æ˜¯ç¬¬ 43 ç¯‡ä¸æºæ°´çš„åŸåˆ›ï¼Œæƒ³è·å–æ›´å¤šåŸåˆ›å¥½æ–‡ï¼Œè¯·æ‰« ğŸ‘†ä¸Šæ–¹äºŒç»´ç å…³æ³¨æˆ‘ä»¬å§~"),v,d(" > æœ¬æ–‡é¦–å‘äºæ”¿é‡‡äº‘å‰ç«¯å›¢é˜Ÿåšå®¢ï¼š"),e("a",u,[d("webpack-dev-middleware æºç è§£è¯»"),i(n)])]),p,e("p",null,[d("Webpack çš„ä½¿ç”¨ç›®å‰å·²ç»æ˜¯å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆå¿…å¤‡æŠ€èƒ½ä¹‹ä¸€ã€‚è‹¥æ˜¯æƒ³åœ¨æœ¬åœ°ç¯å¢ƒå¯åŠ¨ä¸€ä¸ªå¼€å‘æœåŠ¡ï¼Œå¤§å®¶åªéœ€åœ¨ webpack çš„é…ç½®ä¸­ï¼Œå¢åŠ  "),e("a",m,[d("devServer"),i(n)]),d(" çš„é…ç½®æ¥å¯åŠ¨ã€‚è€Œ devServer é…ç½®çš„æœ¬è´¨æ˜¯ webpack-dev-server è¿™ä¸ªåŒ…æä¾›çš„åŠŸèƒ½ï¼Œè€Œ webpack-dev-middleware åˆ™æ˜¯è¿™ä¸ªåŒ…çš„åº•å±‚ä¾èµ–ã€‚")]),b,e("p",null,[d("é€šè¿‡å¯åŠ¨ä¸€ä¸ª "),e("a",h,[d("express"),i(n)]),d(" æœåŠ¡ï¼Œå°† "),x,d(" çš„ç»“æœé€šè¿‡ "),w,d(" æ–¹æ³•æ³¨å†Œä¸º express æœåŠ¡çš„ä¸­é—´å‡½æ•°ã€‚ä»è¿™é‡Œï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡º "),_,d(" çš„æ‰§è¡Œç»“æœè¿”å›çš„æ˜¯ä¸€ä¸ª "),g,d(" çš„ä¸­é—´ä»¶ã€‚å®ƒä½œä¸ºä¸€ä¸ªå®¹å™¨ï¼Œå°† "),k,d(" ç¼–è¯‘åçš„æ–‡ä»¶å­˜å‚¨åˆ°å†…å­˜ä¸­ï¼Œç„¶ååœ¨ç”¨æˆ·è®¿é—® "),f,d(" æœåŠ¡æ—¶ï¼Œå°†å†…å­˜ä¸­å¯¹åº”çš„èµ„æºè¾“å‡ºè¿”å›ã€‚")]),j,e("p",null,[d("ç†Ÿæ‚‰ "),y,d(" çš„åŒå­¦éƒ½çŸ¥é“ï¼Œ"),q,d(" å¯ä»¥é€šè¿‡ "),e("a",S,[d("watch mode"),i(n)]),d(" æ–¹å¼å¯åŠ¨ï¼Œé‚£ä¸ºä½•æˆ‘ä»¬ä¸ç›´æ¥ä½¿ç”¨æ­¤æ–¹å¼æ¥ç›‘å¬èµ„æºå˜åŒ–å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ï¼Œ"),R,d(" çš„ "),E,d(" è™½ç„¶èƒ½ç›‘å¬æ–‡ä»¶çš„å˜æ›´ï¼Œå¹¶ä¸”è‡ªåŠ¨æ‰“åŒ…ï¼Œä½†æ˜¯æ¯æ¬¡æ‰“åŒ…åçš„ç»“æœå°†ä¼šå­˜å‚¨åˆ°æœ¬åœ°ç¡¬ç›˜ä¸­ï¼Œè€Œ IO æ“ä½œæ˜¯éå¸¸è€—èµ„æºæ—¶é—´çš„ï¼Œæ— æ³•æ»¡è¶³æœ¬åœ°å¼€å‘è°ƒè¯•éœ€æ±‚ã€‚")]),N,e("p",null,[d("æ­¤éƒ¨åˆ†çš„ä½œç”¨æ˜¯ï¼Œè°ƒç”¨ "),D,d(" çš„ "),e("a",F,[d("watch"),i(n)]),d(" æ–¹æ³•ï¼Œä¹‹å "),M,d(" ä¾¿ä¼šç›‘å¬æ–‡ä»¶å˜æ›´ï¼Œä¸€æ—¦æ£€æµ‹åˆ°æ–‡ä»¶å˜æ›´ï¼Œå°±ä¼šé‡æ–°æ‰§è¡Œç¼–è¯‘ã€‚")]),T,e("p",null,[d("å…¶ä½œç”¨æ˜¯ä½¿ç”¨ "),e("a",H,[d("memory-fs"),i(n)]),d(" å¯¹è±¡æ›¿æ¢æ‰ "),O,d(" çš„æ–‡ä»¶ç³»ç»Ÿå¯¹è±¡ï¼Œè®© "),W,d(" ç¼–è¯‘åçš„æ–‡ä»¶è¾“å‡ºåˆ°å†…å­˜ä¸­ã€‚")]),B,e("p",null,[e("a",C,[d("å‰ç«¯å·¥ç¨‹å®è·µä¹‹å¯è§†åŒ–æ­å»ºç³»ç»Ÿï¼ˆä¸€ï¼‰"),i(n)])]),e("p",null,[e("a",P,[d("å¯èƒ½æ˜¯æœ€å…¨çš„ â€œæ–‡æœ¬æº¢å‡ºæˆªæ–­çœç•¥â€ æ–¹æ¡ˆåˆé›†"),i(n)])]),e("p",null,[e("a",A,[d("å›¾æ–‡å¹¶èŒ‚ï¼Œä¸ºä½ æ­å¼€â€œå•ç‚¹ç™»å½•â€œçš„ç¥ç§˜é¢çº±"),i(n)])]),I,V,L,U])}const Y=a(r,[["render",z],["__file","webpack-dev-middleware æºç è§£è¯».html.vue"]]);export{Y as default};
